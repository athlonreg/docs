<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="keywords" content="Jenkins-configure-and-deploy" />
	<meta name="description" content="Jenkins是一个开源的、提供友好操作界面的持续集成(CI)工具，起源于Hudson（Hudson是商用的），主要用于持续、自动的构建/测试软件项目、监控外部任务的运行。Jenkins用Java语言编写，可在Tomcat等流行的servlet容器中运行，也可独立运行。通常与版本管理工具(SCM)、构建工具结合使用；常用的版本管理系统有SVN、GIT，构建工具有Maven、Ant、Gradle。" />
	<!-- 网页标签标题 -->
	<title>Jenkins配置部署</title>
	<link rel="shortcut icon" href="/docs/img/docsite.ico"/>
	<link rel="stylesheet" href="/docs/build/documentation.css" />
</head>
<body>
	<div id="root"><div class="documentation-page" data-reactroot=""><header class="header-container header-container-normal"><div class="header-body"><a href="/docs/zh-cn/index.html"><img class="logo" src="/docs/img/dubbo_colorful.png"/></a><div class="search search-normal"><span class="icon-search"></span></div><span class="language-switch language-switch-normal">En</span><div class="header-menu"><img class="header-menu-toggle" src="/docs/img/system/menu_gray.png"/><ul><li class="menu-item menu-item-normal"><a href="/docs/zh-cn/index.html" target="_self">首页</a></li><li class="menu-item menu-item-normal menu-item-normal-active"><a href="/docs/zh-cn/docs/CAS-5-3-4-install-and-deploy.html" target="_self">文档</a></li><li class="menu-item menu-item-normal"><a href="/docs/zh-cn/blog/index.html" target="_self">博客</a></li><li class="menu-item menu-item-normal"><a href="/docs/zh-cn/community/index.html" target="_self">社区</a></li></ul></div></div></header><div class="bar"><div class="bar-body"><img src="/docs/img/system/docs.png" class="front-img"/><span>文档</span><img src="/docs/img/system/docs.png" class="back-img"/></div></div><section class="content-section"><div class="sidemenu"><div class="sidemenu-toggle"><img src="https://img.alicdn.com/tfs/TB1E6apXHGYBuNjy0FoXXciBFXa-200-200.png"/></div><ul><li class="menu-item menu-item-level-1"><span>文档</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/docs/zh-cn/docs/0-1-backpack.html" target="_self">01背包问题</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/docs/zh-cn/docs/Allow-apps-downloaded-from-anywhere-in-macOS.html" target="_self">macOS开启任何来源</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/docs/zh-cn/docs/CAS-5-3-4-install-and-deploy.html" target="_self">CAS 5.3.4 安装部署</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/docs/zh-cn/docs/CentOS-install-openLDAP.html" target="_self">CentOS 安装部署 openLDAP</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/docs/zh-cn/docs/TestLink-integrate-with-ldap-and-CAS.html" target="_self">TestLink 整合 LDAP 和 CAS 单点登录</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/docs/zh-cn/docs/TestLink-install-and-deploy.md.html" target="_self">TestLink 安装部署</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/docs/zh-cn/docs/SonarQube-install-and-deploy.html" target="_self">SonarQube 安装部署</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/docs/zh-cn/docs/SonarQube-integrate-with-ldap-and-CAS.html" target="_self">SonarQube 整合 LDAP 和 CAS 单点登录</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/docs/zh-cn/docs/shadowsocks-libev.html" target="_self">CentOS 搭建 ShadowSocks 访问墙外的世界</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/docs/zh-cn/docs/MantisBT-install-and-deploy.html" target="_self">CentOS 安装部署 MantisBT</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/docs/zh-cn/docs/MantisBT-integrate-with-ldap-and-CAS.html" target="_self">MantisBT 整合 LDAP 和 CAS 单点登录</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/docs/zh-cn/docs/Jenkins-configure-and-deploy.md.html" target="_self">CentOS 安装部署 Jenkins</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/docs/zh-cn/docs/Jenkins-integrate-with-ldap-and-CAS.html" target="_self">Jenkins 整合 LDAP 和 CAS 单点登录</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/docs/zh-cn/docs/Install-macOS-on-laptop.html" target="_self">笔记本安装黑苹果教程</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/docs/zh-cn/docs/Gerrit-install-and-deploy.html" target="_self">CentOS 安装部署 Gerrit</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/docs/zh-cn/docs/Gerrit-integrate-with-ldap-and-CAS.html" target="_self">Gerrit 整合 LDAP 和 CAS 单点登录</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/docs/zh-cn/docs/Custom-terminal-on-your-mac.html" target="_self">iTerm2 + ohmyzsh + powerlevel9k + tmux 打造专属个性化终端</a></li><li style="height:72px;overflow:hidden" class="menu-item menu-item-level-2"><span>目录<img style="transform:rotate(0deg)" class="menu-toggle" src="/docs/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/docs/zh-cn/docs/dir/demo3.html" target="_self">示例3</a></li></ul></li></ul></li></ul></div><div class="doc-content markdown-body"><h1><center><code>Jenkins</code>配置部署</center></h1>
<h2>简介</h2>
<p>Jenkins是一个开源的、提供友好操作界面的持续集成(CI)工具，起源于Hudson（Hudson是商用的），主要用于持续、自动的构建/测试软件项目、监控外部任务的运行。Jenkins用Java语言编写，可在Tomcat等流行的servlet容器中运行，也可独立运行。通常与版本管理工具(SCM)、构建工具结合使用；常用的版本管理系统有SVN、GIT，构建工具有Maven、Ant、Gradle。其具备以下特点：</p>
<ul>
<li>易于安装：不需要安装、不需要数据库，只需通过java -jar jenkins.war或部署到一个servlet容器中。</li>
<li>易于配置：所有的配置都可能通过Jenkins提供的web界面完成，当然如果你喜欢，也可以通过手动修改xml文件进行配置。</li>
<li>消息通知及测试报告：能够生成各类测试报告并通过消息通知机制（Email等）进行报告，包括单元测试、覆盖率测试、静态分析等。</li>
<li>分布式构建：Jenkins支持多个Slave节点的动态挂载，完成分布式构建。</li>
<li>资源动态调度：Jenkins的容器资源通过Kubernetes动态调度，动态扩容收缩。</li>
<li>插件支持：Jenkins支持上千种插件，可以进行扩展，也可以根据需求近定制开发。</li>
</ul>
<h2>安装部署</h2>
<p>以CentOS环境安装部署为例，详细介绍Jenkins安装部署整体过程和常用设置。</p>
<h3>准备工作</h3>
<h4>环境准备</h4>
<p>如果使用Jenkins.war包的形式进行安装，需要提前准备以下环境。</p>
<h5>Java环境准备</h5>
<h6>去官网下载<code>JDK</code>：</h6>
<p><a href="http://www.oracle.com/technetwork/java/javase/downloads/java-archive-javase8-2177648.html">http://www.oracle.com/technetwork/java/javase/downloads/java-archive-javase8-2177648.html</a></p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/81/1b33b7e9dbe92a1515154d0193194f.jpg" alt=""></p>
<h6>安装</h6>
<ul>
<li>将下载得到的<code>jdk-8u161-linux-x64.rpm</code>包保存到<code>Linux</code>主机</li>
</ul>
<pre><code class="language-bash"><span class="hljs-comment"># rpm -ivh jdk-8u161-linux-x64.rpm</span>
</code></pre>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/ad/4301bf0ab8d0d138ded7bc3709fd4a.jpg" alt=""></p>
<h6>环境变量</h6>
<pre><code class="language-bash"><span class="hljs-comment"># vim ~/.bashrc</span>
</code></pre>
<p>在文件的末尾添加以下行</p>
<pre><code>export JAVA_HOME=/usr/java/jdk1.8.0_161
export JRE_HOME=$JAVA_HOME/jre
export CLASSPATH=$JAVA_HOME/lib
export PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin:$CLASSPATH
</code></pre>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/49/6ac74e90a641e355b29b9c4d17deb9.jpg" alt=""></p>
<p>使环境配置生效</p>
<pre><code class="language-bash"><span class="hljs-comment"># source ~/.bashrc</span>
</code></pre>
<h6>测试<code>Java</code>环境</h6>
<pre><code class="language-bash"><span class="hljs-comment"># java -version</span>
</code></pre>
<p>  查看是否正常显示版本信息，若显示则安装成功</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/2f/49c7d622b298ae690db3c13754c1b1.jpg" alt=""></p>
<h5>Tomcat环境准备</h5>
<h6>下载Tomcat</h6>
<blockquote>
<p>地址: <a href="http://mirrors.shu.edu.cn/apache/tomcat/tomcat-8/v8.5.32/bin/apache-tomcat-8.5.32.tar.gz">http://mirrors.shu.edu.cn/apache/tomcat/tomcat-8/v8.5.32/bin/apache-tomcat-8.5.32.tar.gz</a></p>
</blockquote>
<pre><code class="language-bash"><span class="hljs-comment"># wget http://mirrors.shu.edu.cn/apache/tomcat/tomcat-8/v8.5.32/bin/apache-tomcat-8.5.32.tar.gz</span>
</code></pre>
<h6>安装Tomcat</h6>
<pre><code class="language-bash"><span class="hljs-comment"># tar zxvf apache-tomcat-8.5.32.tar.gz</span>
<span class="hljs-comment"># mv apache-tomcat-8.5.32 /usr/local/</span>
</code></pre>
<h6>配置Tomcat环境</h6>
<pre><code class="language-bash"><span class="hljs-comment"># vim ~/.bashrc</span>
</code></pre>
<p>在文件的末尾添加以下行</p>
<pre><code>export CATALINA_BASE=/usr/local/apache-tomcat-8.5.32
export TOMCAT_HOME=/usr/local/apache-tomcat-8.5.32
export CATALINA_HOME=/usr/local/apache-tomcat-8.5.32
export PATH=$PATH:$CATALINA_HOME/bin:$CATALINA_HOME/lib
</code></pre>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/66/1656ee9280886c6c7de6057c8835cd.jpg" alt=""></p>
<p>使环境配置生效</p>
<pre><code class="language-bash"><span class="hljs-comment"># source ~/.bashrc</span>
</code></pre>
<h6>启动Tomcat服务</h6>
<pre><code class="language-bash"><span class="hljs-comment"># startup.sh</span>
</code></pre>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/f9/4e6e503aa6fe748959adfb182e3e1c.jpg" alt=""></p>
<h6>测试Tomcat</h6>
<p>打开浏览器，在地址栏中输入http://IP:8080回车，如果看到Tomcat自带的一个JSP页面，说明你的Tomcat已搭建成功</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/43/36596794bdf3af70f1ecd35f8c40a0.jpg" alt=""></p>
<h3>安装部署</h3>
<h4>下载war文件</h4>
<pre><code># wget http://mirrors.jenkins.io/war-stable/latest/jenkins.war
</code></pre>
<h4>安装Jenkins</h4>
<p>将下载后的war包放到/usr/local/apache-tomcat-8.5.32/webapps/目录下，启动tomcat即可， 或者用命令<code>java -jar jenkins.war</code>。</p>
<h4>测试</h4>
<p>打开浏览器输入http://IP:8080/jenkins回车即可看到jenkin初始配置界面，按照提示进行设置。</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/27/4f737ebea43eb34f747fb68a08b6fa.jpg" alt=""></p>
<h3>常用设置</h3>
<h5>邮件设置</h5>
<p>Jenkins-&gt;系统管理-&gt;系统设置，弹出如下图所示：</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/b0/075e39aad15468d3eb9cc0f6bf37f7.jpg" alt=""></p>
<ul>
<li>SMTP服务器：为邮箱服务地址。
<ul>
<li>QQ: <a href="http://smtp.qq.com">smtp.qq.com</a></li>
<li>163: <a href="http://smtp.163.com">smtp.163.com</a></li>
</ul>
</li>
<li>用户默认后缀：可以自动识别，只需填写用户即可。</li>
<li>其他配置为Jenkins邮箱默认用户及采用的认证方式。</li>
</ul>
<h5>Job设置</h5>
<p>在需要邮件通知的Job设置里面增加&quot;构建后操作步骤&quot; -&gt; 选择E-mail Notification。</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/82/3005620b29b6fc4b2c9e3ce729af8b.jpg" alt=""></p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/9e/a3153b262215e17561eb34674635e2.jpg" alt=""></p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/6d/dce01f6fa0a84d625f0eb55759c422.jpg" alt=""></p>
<h5>扩展插件设置</h5>
<p>但是如果你群发的收件人列表比较多，或者每次通知的人不一样，比如每次只想通知导致构建失败的那个人（即最后一次上传代码的人），那么简单的E-mail Notification就不能满足要求，需要使用Email extension plugin插件。</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/18/0775061dcf193cc08da229cef10eda.jpg" alt=""></p>
<ul>
<li>
<p>SMTP server -- 设置SMTP服务器地址</p>
</li>
<li>
<p>Default user E-mail suffix -- 设置用户默认邮件后缀</p>
</li>
<li>
<p>Default Content Type -- 默认内容类型(Plain Text HTML)</p>
</li>
<li>
<p>Default Subject -- 默认邮件主题</p>
</li>
<li>
<p>Default Content -- 默认邮件内容，可以设置模板</p>
</li>
<li>
<p>Default Triggers -- 触发器</p>
</li>
<li>
<p>[ ] 全局配置
根据实际情况勾选需要触发邮件通知的事件。点击上图右下角Default Trigger，弹出如下触发项：</p>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/69/3127442cf5a527b984d83738c31e6f.jpg" alt=""></p>
<ul>
<li>[ ] 项目配置
进入到具体的项目配置界面点击&quot;配置，在配置界面点击&quot;增加构建后操作步骤&quot;，选择&quot;Editable Email Notification&quot;。</li>
</ul>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/71/133a454b2ee120f2b1df930b4ca9fe.jpg" alt=""></p>
<p>可以在“Advanced Settings”中针对该项目进行个性化的配置。可以针对该项目定义该项目通知的收件人列表、主题、内容、附件等。</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/53/67346392186853caab6ee621418aa4.jpg" alt=""></p>
<h4>任务创建</h4>
<h5>构建项目类型</h5>
<p>点击 Jenkins 首页&quot;创建一个新任务&quot;的链接，弹出如下图所示页面。</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/04/c97a32a6b1285a76a6edb8497a1cd3.jpg" alt=""></p>
<p>Jenkins 提供了六种类型的任务。</p>
<ul>
<li>
<p>构建一个自由风格的软件项目
这是Jenkins的主要功能。Jenkins 会结合任何 SCM 和任何构建系统来构建你的项目, 甚至可以构建软件以外的系统。</p>
</li>
<li>
<p>Pipeline(流水线)
Orchestrates long-running activities that can span multiple build slaves. Suitable for building pipelines (formerly known as workflows) and/or organizing complex activities that do not easily fit in free-style job type. – 很难用一两句话说清 Pipeline, 参考 , 后面另起一文来介绍。</p>
</li>
<li>
<p>构建一个多配置项目
适用于多配置项目,例如多环境测试、平台指定构建,等等。</p>
</li>
<li>
<p>GitHub Organization
Scans a GitHub organization (or user account) for all repositories matching some defined markers. – 这个主要针对由 Github 托管的项目。</p>
</li>
<li>
<p>Multibranch Pipeline(多分支流水线)
Creates a set of Pipeline projects according to detected branches in one SCM repository. 根据一个SCM存储库中检测到的分支创建一组 Pipeline 项目。</p>
</li>
<li>
<p>文件夹
创建一个可以嵌套存储的容器。利用它可以进行分组。 视图仅仅是一个过滤器，而文件夹则是一个独立的命名空间， 因此你可以有多个相同名称的的内容，只要它们在不同的文件 夹里即可。</p>
</li>
</ul>
<p>这里选择第一个：构建一个自由风格的软件项目， 输入项目名称：python test project ，点击&quot;确定&quot;按钮。</p>
<h5>构建 Windows 测试任务</h5>
<p>假设，有一个 Python 编写的测试脚本 py_tests.py ，其绝对路径为/root/py_tests.py，内容如下：</p>
<pre><code class="language-python"><span class="hljs-keyword">print</span> <span class="hljs-string">"Hello world"</span>
</code></pre>
<p>在Linux下怎么执行这个测试用例，打开终端</p>
<pre><code>[root@centos-7 ~]# cd
[root@centos-7 ~]# ll py_tests.py
-rw-r--r--. 1 root root 20 8月  16 16:07 py_tests.py
[root@centos-7 ~]# python py_tests.py
Hello world
[root@centos-7 ~]#
</code></pre>
<p>下面回到Jenkins的配置过程中</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/ab/46e2f5d22700eb539eac4128e19c85.jpg" alt=""></p>
<p>添加项目的描述：Python 测试项目，打印Hello world。</p>
<p>剩下的选项都不要管，拖到页面底部，构建 选项。</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/e0/dab0e9e3d049db8a84ee83f85582de.jpg" alt=""></p>
<p>选择<code>执行shell</code>选项，执行Linux shell命令。</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/c6/ef1db64d383033d03b465af7f3771d.jpg" alt=""></p>
<p>如上图，输入你在 Linux 终端下所输的命令<code>python /root/py_tests.py</code>。 点击<code>保存</code>。</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/8f/6c232d4632eb024fa2cadcf0fbfc13.jpg" alt=""></p>
<p>一个极简的，基于 Linux 系统的 Python 脚本测试持续集成项目就创建完成了。</p>
<h4>节点添加</h4>
<p>Jenkins有个很强大的功能：分布式构建(在Jenkins的配置中叫做节点)，分布式构建能够让同一套代码在不同的环境(如：Windows和Linux系统)中编译、测试等。而且Jenkins构建的代码和产物最后自动拷贝到主节点。</p>
<p><strong>注意：如果节点主机上不存在JDK，Jenkins会去自动下载。</strong></p>
<p><strong>建议：所有Unix或者Windows机器的环境路径统一(如：JDK、Ant、Maven)，好处是便于管理、不容易出现奇葩问题。</strong></p>
<h5>新建节点</h5>
<p>系统管理 → 管理节点 → 新建节点(左上角)，如下图所示：</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/1e/067a4f7fa85272fa79f85208c937c0.jpg" alt=""></p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/eb/3eb8f07110c1e29abe65035fdc2b04.jpg" alt=""></p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/bb/e82fc1380ecf612e70e06bc156e17e.jpg" alt=""></p>
<p>  节点名称：建议使用字母、数字或字母和数字的组合。最好见名知意。不建议使用标点符号和中文(中文命名没有问题，但Job中无法引用)。</p>
<h5>配置节点</h5>
<ul>
<li>Name(名称)：节点名称</li>
<li>Description(描述)：节点描述，支持中文</li>
<li>并发构建数：最大同时构建数量(根据机器的性能定，单颗四核cpu建议不要超过5) - 必须为数字</li>
<li>远程工作目录：节点的根目录(注意：如果目录不存在，会自动创建目录。你必须对该目录有读写权限，不然会报错)</li>
<li>标签：标记(又叫做标签)用来对多节点分组,标记之间用空格分隔.例如'refression java6'将会把一个节点标记上'regression'和'java6'.</li>
</ul>
<blockquote>
<p>例来说,如果你有多个Linux系统的构建节点并且你的Job也需要在Linux系统上运行,那么你可以配置所有的Linux系统节点都标记为'windows', 然后把Job也标记为'Linux'.这样的话你的Job就不会运行在除了Linux节点以外的其它节点之上了.
Linux用法：尽可能的使用这个节点/只允许运行绑定到这台机器的Job(根据你的需求，二选一)</p>
</blockquote>
<ul>
<li>启动方式：
<ul>
<li>Linux节点：推荐 -- Launch slave agents via SSH， 在Unix(包括Linux)机器上通过SSH通道连接节点 (适用于Unix和Linux)</li>
<li>Host(主机)：节点主机的ip地址</li>
<li>Credentials：凭据(如果为空或者不可选择，请在系统管理→Manage Credentials中配置。Manage Credentials的配置非常简单，这里就不在描述了。Manage Credentials配置完成后，需刷新节点配置页面才会显示。)</li>
</ul>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/35/d7416430314fd19e34a01ac59ff464.jpg" alt=""></p>
<h5>节点连接</h5>
<p>以Launch slave agents via SSH为例，选择Manually trusted key Verification Strategy，然后点击最下面的保存。</p>
<p>Jenkins -&gt; 系统管理 -&gt; 系统设置，设置SSH Server</p>
<ul>
<li>Name: 这个可以随意写</li>
<li>Hostname: 远程主机的IP地址</li>
<li>Username: 远程主机登录的用户名</li>
<li>Remote Directory: 远程目录</li>
</ul>
<p>如图设置好信息后，点击下面的保存</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/3f/b787c0c1b5bab76ad878fbb47542ad.jpg" alt=""></p>
<p>Jenkins -&gt; 系统管理 -&gt; 管理节点，点击刚刚配置好的节点，上线节点</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/1d/1f61d958c23269f4fcc4a7ae295b0b.jpg" alt=""></p>
<p>回到节点列表后发现节点就已经成功上线了</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/a4/346c91e15903e43bc6759a7c566502.jpg" alt=""></p>
<h4>角色权限</h4>
<p>由于jenkins默认的权限管理体系不支持用户组或角色的配置，因此需要安装第三发插件来支持角色的配置，本文将使用Role Strategy Plugin，介绍页面：<a href="https://wiki.jenkins-ci.org/display/JENKINS/Role+Strategy+Plugin%E3%80%82">https://wiki.jenkins-ci.org/display/JENKINS/Role+Strategy+Plugin。</a></p>
<h5>配置插件</h5>
<p>安装插件后，进入系统设置页面，配置如下：</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/89/a69327d3e04b1b57ff022132e9f5a5.jpg" alt=""></p>
<h5>配置权限</h5>
<p>在系统管理页面点击Manage and Assign Roles进入角色管理页面</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/90/a06f0b7e2eff8c0a9d81576497ff0c.jpg" alt=""></p>
<p>进入之后</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/be/1bbe3e8858dbac44ac5a1fa2451883.jpg" alt=""></p>
<ul>
<li>管理角色（Manage Roles）
选择该项可以创建全局角色、项目角色，并可以为角色分配权限。</li>
</ul>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/b8/ea91c0ea7091dca3faf3c86356da16.jpg" alt=""></p>
<p>;如上图，分别创建了admin、anonymous两个全局角色，Online Program、test两个项目角色。</p>
<p>  项目角色与全局角色的区别就是，项目角色只能管理项目，没有管理jenkins的权限配置。</p>
<p>  添加项目角色时，需要指定匹配项目的模式，如上图中的Pattern，官方文档介绍该选项支持正则表达式，如&quot;Roger-.&quot;表示所有以Roger-开头的项目，<code>(?i)roger-.*</code>表示以roger-开头的项目并且不区分大小写，如以ABC开头的项目可以配置为&quot;ABC|ABC.*&quot;，也可以使用&quot;abc|bcd|efg&quot;直接匹配多个项目。</p>
<ul>
<li>创建用户
在分配角色之前需要先创建用户。
在系统管理页面，点击管理用户：</li>
</ul>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/2e/6a8a273181a5357a4ca587a5c2ced9.jpg" alt=""></p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/60/d8fa2030fff834872c259f65720958.jpg" alt=""></p>
<p>  点击新建使用者可以创建新用户，点击用户ID或名称都可以修改用户信息。</p>
<p>  选择Assign Roles可以为用户分配所属角色，可以分配全局角色和项目角色。</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/57/385c466d213dd9ead86034162d9029.jpg" alt=""></p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/93/ddef492ecd2995c5731ea8eb1e9ee1.jpg" alt=""></p>
<p>  如上图，将不同的用户分别分配给不同的角色，这样用户就可以具有角色所拥有的权限。</p>
<h3>运行与维护</h3>
<h4>Jenkins升级</h4>
<ul>
<li>说明：Jenkins迭代更新很频繁，一般1周更新一次，半年一个大版本。</li>
<li>升级：下载新的war包，替换旧的war包，重启即可。下载地址为http://mirrors.jenkins-ci.org/。</li>
</ul>
<p><strong>PS：升级前，请测试该版本和你本地数据的兼容性。如何测试：将JENKINS_HOME拷贝一份到新的机器，用新版的程序启动。测试对应的插件和配置。</strong></p>
<h4>Jenkins迁移和备份</h4>
<p>首先找到JENKINS_HOME，一般在用户根目录下.jenkins目录，因为Jenkins的所有的数据都是以文件的形式存放在JENKINS_HOME目录中。所以不管是迁移还是备份，只需要操作JENKINS_HOME就行了。</p>
<ul>
<li>
<p>迁移：建议将JENKINS_HOME打包后再拷贝，Windows上可以用zip，rar等，Linux上有zip，tar等。然后将打包的文件解压到新的JENKINS_HOME目录就行了。</p>
</li>
<li>
<p>备份：如果是临时备份，整个压缩文件就行了。</p>
</li>
<li>
<p>恢复：恢复的时候需要先停止jenkins。</p>
</li>
</ul>
<h4>移动，删除或修改jobs</h4>
<p>对于移动或删除jobs，只需要简单地移动或删除<code>$JENKINS_HOME/jobs</code>目录。
对于修改jobs的名字，只需要简单地修改<code>$JENKINS_HOME/jobs</code>下对应job的文件夹的名字。
对于不经常使用的job，只需要对<code>$JENKINS_HOME/jobs</code>下对应的jobs的目录zip或tar后存储到其他的地方。</p>
<h4>Jenkins 启动时的命令行参数</h4>
<table>
<thead>
<tr>
<th><code>--httpPort=$HTTP_PORT</code></th>
<th>用来设置jenkins运行时的web端口。</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--httpsPort=$HTTP_PORT</code></td>
<td>表示使用https协议。</td>
</tr>
<tr>
<td>~~~~--httpListenAddress=$HTTP_HOST</td>
<td>用来指定jenkins监听的ip范围，默认为所有的ip都可以访问此jenkins server。</td>
</tr>
</tbody>
</table>
<h4>修改jenkins的timezone</h4>
<p>如果jenkins所在的server的timezone不同于用户的timezone，这时候需要修改jenkins的timezone，需要在jenkins启动的时候增加下列参数-Dorg.apache.commons.jelly.tags.fmt.timeZone=TZ。</p>
<h4>查看jenkins的系统信息</h4>
<p>以在jenkins的管理页面下的系统信息中，查看所有的jenkins的信息，例如jenkins的启动配置，所依赖的系统的环境变量，所安装的plugins。</p>
<h4>Jenkins中执行batch和Python</h4>
<p>Jenkins的job -&gt; build 支持Ant，maven，windows batch和Shell， 但是我们知道python，perl，ruby等脚本其实也是shell脚本，所以这里的Shell可以扩展为python，perl，ruby等。如图</p>
<p><img src="https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/99/04a1d6c847be966e185435823bb110.jpg" alt=""></p>
<h3>Jenkins 整合 LDAP 以及 CAS 单点登录</h3>
<p>参考另外一篇博客
<a href="https://blog.iamzhl.top/Jenkins-integrate-with-ldap-and-CAS.html">Jenkins 整合 LDAP 以及 CAS 单点登录</a></p>
</div></section><footer class="footer-container"><div class="footer-body"><img src="/docs/img/dubbo_gray.png"/><div class="cols-container"><div class="col col-12"><h3>免责声明</h3><p>文档所有内容遵循开源协议</p></div><div class="col col-6"><dl><dt>文档</dt><dd><a href="/docs/zh-cn/docs/CAS-5-3-4-install-and-deploy.html" target="_self">概览</a></dd><dd><a href="/docs/zh-cn/docs/CAS-5-3-4-install-and-deploy.html" target="_self">快速开始</a></dd><dd><a href="/docs/zh-cn/docs/dir/CAS-5-3-4-install-and-deploy.html" target="_self">开发者指南</a></dd></dl></div><div class="col col-6"><dl><dt>资源</dt><dd><a href="/docs/zh-cn/blog/index.html" target="_self">博客</a></dd><dd><a href="/docs/zh-cn/community/index.html" target="_self">社区</a></dd></dl></div></div><div class="copyright"><span>Copyright © 2018 https://blog.iamzhl.top/</span></div></div></footer></div></div>
	<script src="https://f.alicdn.com/react/15.4.1/react-with-addons.min.js"></script>
	<script src="https://f.alicdn.com/react/15.4.1/react-dom.min.js"></script>
	<script>
		window.rootPath = '/docs';
  </script>
	<script src="/docs/build/documentation.js"></script>
</body>
</html>