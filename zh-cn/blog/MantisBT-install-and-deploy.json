{
  "filename": "MantisBT-install-and-deploy.md",
  "__html": "<h1><strong><center>MantisBT软件安装部署过程</center></strong></h1>\n<h1>简介</h1>\n<p>    Mantis是一个基于PHP技术的轻量级的开源缺陷跟踪系统，以Web操作的形式提供项目管理及缺陷跟踪服务。在功能上、实用性上足以满足中小型项目的管理及跟踪。更重要的是其开源，不需要负担任何费用。</p>\n<h1>部署环境</h1>\n<p>Mantis安装部署环境如下：</p>\n<table>\n<thead>\n<tr>\n<th>名称</th>\n<th>版本号</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Mantisbt</td>\n<td>2.16.0</td>\n<td>BugTracing 软件</td>\n</tr>\n<tr>\n<td>操作系统</td>\n<td>CentOS 7</td>\n<td>RedHat 社区发行版</td>\n</tr>\n<tr>\n<td>PHP</td>\n<td>7.2.8</td>\n<td>PHP 环境</td>\n</tr>\n</tbody>\n</table>\n<h1>部署过程</h1>\n<h2>软件安装</h2>\n<h3>安装PHP</h3>\n<pre><code class=\"language-bash\"><span class=\"hljs-comment\"># rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</span>\n<span class=\"hljs-comment\"># rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm</span>\n<span class=\"hljs-comment\"># yum -y install libicu libicu-devel libicu-doc</span>\n<span class=\"hljs-comment\"># yum -y install php70w php70w-gd php70w-xml php70w-mysql php70w-mbstring php70w-ldap php70w-xmlrpc php70w-odbc php70w-pear php70w-soap php70w-snmp</span>\n</code></pre>\n<h3>安装PHPMailer</h3>\n<pre><code>https://github.com/Synchro/PHPMailer/releases/tag/v5.2.13\n</code></pre>\n<p>下载解压到/var/www/html/mantis/PHPMailer-5.2.13/</p>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/0b/f7ba2cdc89ecb4edee3d7c32861ad1.jpg\" alt=\"\"></p>\n<h3>安装apache mysql等必要软件</h3>\n<p>MySQL的Server在CentOS 7上从默认软件列表中被移除了，用MariaDB来代替，所以这导致我们必须要去官网上进行下载，找到链接，用wget打开，然后再安装：</p>\n<pre><code class=\"language-bash\"><span class=\"hljs-comment\"># wget http://dev.mysql.com/get/mysql57-community-release-el7-9.noarch.rpm</span>\n<span class=\"hljs-comment\"># rpm -ivh mysql57-community-release-el7-9.noarch.rpm</span>\n<span class=\"hljs-comment\"># yum -y install mysql mysql-server mysql-devel</span>\n</code></pre>\n<p>启动MySQL服务</p>\n<pre><code class=\"language-bash\"><span class=\"hljs-comment\"># systemctl start mysqld</span>\n</code></pre>\n<p>获取安装MySQL时的初始密码并登录MySQL</p>\n<pre><code class=\"language-bash\"><span class=\"hljs-comment\"># grep 'temporary password' /var/log/mysqld.log</span>\n<span class=\"hljs-comment\"># mysql -u root -p</span>\n</code></pre>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/4a/a001ae2bae5a494c7329cd78a477a3.jpg\" alt=\"\"></p>\n<p>登录成功后修改密码，首先修改安全策略为0，然后将密码长度限制修改为1，最后修改密码</p>\n<pre><code class=\"language-mysql\">mysql&gt; set global validate_password_policy=0;\nmysql&gt; set global validate_password_length=1;\nmysql&gt; set password for root@localhost=password('root');\n</code></pre>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/a2/0f74ed53f3a426d1fe005228478d8f.jpg\" alt=\"\"></p>\n<p>安装apache httpd</p>\n<pre><code class=\"language-bash\"><span class=\"hljs-comment\"># yum -y install httpd</span>\n<span class=\"hljs-comment\"># systemctl enable httpd   //自启动</span>\n<span class=\"hljs-comment\"># systemctl start httpd    //启动</span>\n</code></pre>\n<h3>安装mantis</h3>\n<h4>下载</h4>\n<pre><code class=\"language-bash\"><span class=\"hljs-comment\"># cd /var/www/html</span>\n<span class=\"hljs-comment\"># wget https://jaist.dl.sourceforge.net/project/mantisbt/mantis-stable/2.18.0/mantisbt-2.18.0.zip</span>\n</code></pre>\n<h4>解压重命名</h4>\n<pre><code class=\"language-bash\"><span class=\"hljs-comment\"># tar zxvf mantisbt-2.16.0.tar.gz</span>\n<span class=\"hljs-comment\"># mv mantisbt-2.16.0 mantis</span>\n<span class=\"hljs-comment\"># mv mantis /var/www/html/</span>\n</code></pre>\n<h4>修改用户组</h4>\n<pre><code class=\"language-bash\"><span class=\"hljs-comment\"># chown -R apache:apache /var/www/html/mantis</span>\n</code></pre>\n<h4>创建数据库</h4>\n<pre><code class=\"language-bash\">[root@centos-7 html]<span class=\"hljs-comment\"># mysql -u root -p</span>\nEnter password:\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 8\nServer version: 5.7.23 MySQL Community Server (GPL)\n\nCopyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType <span class=\"hljs-string\">'help;'</span> or <span class=\"hljs-string\">'\\h'</span> <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">help</span>. Type <span class=\"hljs-string\">'\\c'</span> to clear the current input statement.\n\nmysql&gt; create database mantis;\nQuery OK, 1 row affected (0.00 sec)\n\nmysql&gt; grant all privileges on mantis.* to root@localhost identified by <span class=\"hljs-string\">'123456'</span>;\nERROR 1819 (HY000): Your password does not satisfy the current policy requirements\nmysql&gt; <span class=\"hljs-built_in\">set</span> global validate_password_policy=0;\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql&gt; <span class=\"hljs-built_in\">set</span> global validate_password_length=1;\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql&gt; grant all privileges on mantis.* to root@localhost identified by <span class=\"hljs-string\">'123456'</span>;\nQuery OK, 0 rows affected, 1 warning (0.01 sec)\n\nmysql&gt; flush privileges;\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql&gt; <span class=\"hljs-built_in\">exit</span>\nBye\n[root@centos-7 html]<span class=\"hljs-comment\">#</span>\n</code></pre>\n<h4>安装</h4>\n<p>打开浏览器在地址栏输入 <a href=\"http://10.211.55.17:82/mantis\">http://10.211.55.17:82/mantis</a>  --  格式为 <code>http://IP:端口/mantis文件夹名称</code>，这时就会自动跳转到php安装向导的页面:</p>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/13/430b174ae372e2c4854b5804123ab1.jpg\" alt=\"\"></p>\n<p>    填好主机、密码等信息之后点击 Install/Upgrade Database 安装数据库。</p>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/86/f2dd1067427ccefb9829d5a3e2903e.jpg\" alt=\"\"></p>\n<h4>登录</h4>\n<p>进入Mantis登录界面，输入用户密码：administrator/root ，登陆即可看到mantis主界面。</p>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/b1/c3e84af9570ae5c9d61d788d482a69.jpg\" alt=\"\"></p>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/f4/2302c64875ae7556c732820ffe6c2f.jpg\" alt=\"\"></p>\n<h2>邮件配置</h2>\n<p>修改MantisBT/config/config_inc.php文件</p>\n<pre><code>$g_enable_email_notification = ON;\n$g_administrator_email = 'mailuser';    # 邮箱地址\n$g_webmaster_email = 'mailuser';        # 邮箱地址\n$g_from_email = 'mailuser';             # 邮箱地址\n$g_from_name = 'Mantis Bug Tracker';\n$g_phpMailer_method = PHPMAILER_METHOD_SMTP;\n$g_smtp_host = 'smtp.163.com';          # SMTP 服务器\n$g_smtp_username = 'mailuser';          # 邮箱地址\n$g_smtp_password = 'mailpwd';           # 邮箱密码\n$g_use_phpMailer = ON; \n$g_return_path_email = 'mailuser';      # 邮箱地址\n</code></pre>\n<h2>中文配置</h2>\n<p>修改/var/www/html/mantis/config_defaults_inc.php文件，在该文件中找到语言设置的地方，修改$g_default_language，将'english'改为'chinese_simplified'。懒得找的话直接复制下面的命令也可以。</p>\n<pre><code class=\"language-bash\"><span class=\"hljs-comment\"># sed -i -e \"s/$g_default_language = 'auto'/$g_default_language = 'chinese_simplified'/g\" /var/www/html/mantis/config_defaults_inc.php</span>\n</code></pre>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/17/52f55640c0580b49bb51e81728e32b.jpg\" alt=\"\"></p>\n<h1>问题解决</h1>\n<p>问题描述：配置完成后，无法发送邮件。</p>\n<p>解决方法：\n邮箱配置问题，添加本地邮箱服务器，设置本地邮箱，对于本地测试邮箱，设置$g_smtp_host=本地IP地址。</p>\n<h1>实例运行</h1>\n<ul>\n<li>为了便于理解，先给出BUG跟踪流程图：</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/b7/a17671861ee0f1c0ef2d34063c1f7e.png\" alt=\"\"></p>\n<ul>\n<li>Mantis使用流程图：</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/36/e0cd2969561f3a3847f00064f10d86.jpg\" alt=\"\"></p>\n<ul>\n<li>新用户创建与登录</li>\n</ul>\n<p>目前本系统的访问地址为：<a href=\"http://IP\">http://IP</a>:port/mantis/login_page.php，用户可以通过首页显示的&quot;注册一个新帐号&quot;进行新用户注册。</p>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/7d/1aa6506c45bdc101125dbf0eb471cb.jpg\" alt=\"\"></p>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/e0/c44b7bd62656a42effb30cbe072d8d.jpg\" alt=\"\"></p>\n<p>然后点击邮箱内的激活邮件，进行用户名与密码的设置。也可以通过管理员创建新用户</p>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/f3/3984a7b93cb83f5018a886334554f3.jpg\" alt=\"\"></p>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/38/81f16e90a837e3b2e4753481d53d49.jpg\" alt=\"\"></p>\n<p>管理员可以对用户的角色、所属的项目以及一些其他的情况进行对应的配置。</p>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/7e/8a3bf7d3b7d54549861c08cc2b8695.jpg\" alt=\"\"></p>\n<p>各种具体的配置以及各种角色用户的权限可参见管理员的管理视图。</p>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/64/fb372744682c06a5abf50d6d08e3c3.jpg\" alt=\"\"></p>\n<p><strong>操作流程</strong>\n首先，说明一下系统中的角色和一般所对应的人员：观察者（复查员）、报告者（测试员）、升级者（审核员）、开发人员（开发员）、经理（项目经理）、管理员（系统管理员）。还要简单说明一下问题状态及相关含义（以上的两点只是中文理解和中文翻译的问题，可以在mantisbt-2.15.0/lang/strings_chinese_simplified.txt中修改）：</p>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/32/a9311c413f72019f384eb9fdb64e91.jpg\" alt=\"\"></p>\n<ul>\n<li>新建：新提交的报告，默认状态为新建</li>\n<li>反馈：修正的问题经过测试后仍不完善</li>\n<li>认可：报告的问题确实存在</li>\n<li>已确认：通常为项目经理确认时使用</li>\n<li>已分配：分派给具体开发人员</li>\n<li>已解决：修改后的问题，可以进行测试</li>\n<li>已关闭：测试通过的问题，或者在报告周期内判定为无需修改的问题。</li>\n</ul>\n<p>下面介绍一下简单的操作流程，这里以管理员和报告者作为示例，这里为了方便示例，示例中管理员包含了其他角色属性。观察者、升级者以及经理可以根据具体情况进行添加。</p>\n<ul>\n<li>提交问题</li>\n</ul>\n<p>**权限：**全部角色\n**必填信息：**分类、摘要、描述、查看权限\n**选填信息：**出现频率、严重性、优先级、选择平台设置、重现步骤、辅助、标签、上传文件。\n**问题单状态：**新建</p>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/7a/b1f51f397d2700ccd2ae21cc7edbc7.jpg\" alt=\"\"></p>\n<ul>\n<li>审核问题</li>\n</ul>\n<p>**权限：**审核员、项目经理、（开发员）\n**可进行操作：**添加附件、添加注释\n**问题单状态：**新建 -&gt; 已审核（认可），审核员对问题进行审核，并确认此问题；新建 -&gt; 已关闭，审核员认为报告的问题不存在或无需修改。</p>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/cc/cf2fa843e333b7b168418e13720f06.jpg\" alt=\"\"></p>\n<ul>\n<li>确认问题</li>\n</ul>\n<p>**权限：**项目经理\n**问题单状态：**认可 -&gt; 已确认，项目经理确认问题，确认后进入修改流程；认可 -&gt; 反馈，项目经理对问题存在异议，反馈给审核者。</p>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/61/b450cb7f3eb6af3ce04b1e071dd25e.jpg\" alt=\"\"></p>\n<ul>\n<li>分派问题</li>\n</ul>\n<p>**权限：**项目经理、开发员\n**问题单状态：**已确认 -&gt; 已分派，项目经理分派问题给相应的开发人员；已分派 -&gt; 已分派，开发组长也可以给组员分派问题。\n<img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/97/1e02d524da8f78c447a2fae2b0ceb3.jpg\" alt=\"\"></p>\n<ul>\n<li>修复问题</li>\n</ul>\n<p>**权限：**开发员\n**问题单状态：**已分派 -&gt; 已解决，分派给开发员的问题已修复及内部测试，可以提交业务测试时。\n<img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/46/f8d53110204d554fe1339fa16d4d98.jpg\" alt=\"\"></p>\n<ul>\n<li>测试问题</li>\n</ul>\n<p>**权限：**报告者\n**问题单状态：**已解决 -&gt; 已关闭，报告者对已解决的问题测试且测试通过；已解决 -&gt; 反馈，报告者对已解决的问题测试，而测试未通过，开发员可对反馈的问题继续修复，再进入后续环节。</p>\n<p><img src=\"https://raw.githubusercontent.com/athlonreg/BlogImages/master/Images/93/d945f5412b7aece0c5595564633ad6.jpg\" alt=\"\"></p>\n<p>到此，整个流程结束。\n<strong>说明：整个流程中，问题处于不同的状态，标记的颜色不同。</strong></p>\n",
  "link": "/zh-cn/blog/MantisBT-install-and-deploy.html",
  "meta": {
    "title": "MantisBT安装部署过程",
    "date": "2018-08-18 13:53:09",
    "categories": "",
    "- Linux": "",
    "- 运维": "",
    "keywords": "",
    "- MantisBT": "",
    "- Bug追踪": "",
    "description": "MantisBT是一个基于PHP技术的轻量级的开源缺陷跟踪系统，以Web操作的形式提供项目管理及缺陷跟踪服务。在功能上、实用性上足以满足中小型项目的管理及跟踪。更重要的是其开源，不需要负担任何费用。本文简介MantisBT的安装部署过程。",
    "tags": "",
    "photos": "",
    "- https": "//raw.githubusercontent.com/athlonreg/BlogImages/master/Images/b1/c3e84af9570ae5c9d61d788d482a69.jpg"
  }
}